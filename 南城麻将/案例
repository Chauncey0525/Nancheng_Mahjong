# 南城麻将算分案例

## 案例1

**游戏情况：**
- 东方是庄家，东方暗杠，西方点杠南方，南方自摸碰碰胡
- 东方3个码，南方4个码，西方2个码，北方3个码

### 计算结果

#### 胡分明细
- 东方 → 南方：10分（碰碰胡5分，东方是庄家，翻倍）
- 西方 → 南方：5分（碰碰胡5分）
- 北方 → 南方：5分（碰碰胡5分）

#### 杠分明细
- 南方 → 东方：2分（暗杠）
- 西方 → 东方：2分（暗杠）
- 北方 → 东方：2分（暗杠）
- 西方 → 南方：2分（点杠，点杠者）
- 东方 → 南方：4分（点杠，其余玩家，因为南方是庄家，翻倍）
- 北方 → 南方：1分（点杠，其余玩家）

#### 最终得分（买码规则）

**东方：总分 = -184分**
- 对南方：(基础分-12) × 倍数5(1+码数4) = -60分
- 对西方：(基础分+2) × 倍数3(1+码数2) = +6分
- 对北方：(基础分+2) × 倍数4(1+码数3) = +8分
- 小计 = -60+6+8 = -46分
- 最终得分 = -46 × 倍数4(1+码数3) = -184分

**南方：总分 = +465分**
- 对东方：(基础分+12) × 倍数4(1+码数3) = +48分
- 对西方：(基础分+7) × 倍数3(1+码数2) = +21分
- 对北方：(基础分+6) × 倍数4(1+码数3) = +24分
- 小计 = 48+21+24 = +93分
- 最终得分 = 93 × 倍数5(1+码数4) = +465分

**西方：总分 = -129分**
- 对东方：(基础分-2) × 倍数4(1+码数3) = -8分
- 对南方：(基础分-7) × 倍数5(1+码数4) = -35分
- 小计 = -8-35 = -43分
- 最终得分 = -43 × 倍数3(1+码数2) = -129分

**北方：总分 = -152分**
- 对东方：(基础分-2) × 倍数4(1+码数3) = -8分
- 对南方：(基础分-6) × 倍数5(1+码数4) = -30分
- 小计 = -8-30 = -38分
- 最终得分 = -38 × 倍数4(1+码数3) = -152分

**验证结果：** ✓ 正确（每方得分总和为0）

---

## 计算说明

### 买码规则
1. **第一步**：计算每个玩家对其他玩家的得分
   - 公式：`(胡分+杠分) × (1 + 对方的码数)`
   - 倍数 = 1 + 码数（基础倍数1，每有1只码是多一倍）

2. **第二步**：计算每个玩家的最终得分
   - 公式：`最终得分 = (对所有其他玩家的得分之和) × (1 + 自己的码数)`

### 本案例详细计算过程

#### 东方对南方的基础分计算
- 胡分：东方需要支付给南方10分（碰碰胡5分，东方是庄家，翻倍）
- 杠分：东方需要支付给南方4分（点杠，其余玩家，因为南方是庄家，翻倍）
- 基础分 = -10 - 4 = -14分

**但实际计算中：**
- 东方对南方：需要支付10分（胡分）+ 4分（杠分）= 14分
- 南方对东方：需要支付2分（暗杠）
- 净支付 = -14 + 2 = -12分（东方需要净支付12分给南方）

#### 东方对西方的基础分计算
- 西方对东方：需要支付2分（暗杠）
- 基础分 = +2分

#### 东方对北方的基础分计算
- 北方对东方：需要支付2分（暗杠）
- 基础分 = +2分

#### 东方最终得分
- 对南方：-12 × 5 = -60分
- 对西方：+2 × 3 = +6分
- 对北方：+2 × 4 = +8分
- 小计 = -60 + 6 + 8 = -46分
- 最终得分 = -46 × 4 = -184分

#### 南方最终得分
- 对东方：+12 × 4 = +48分
- 对西方：+7 × 3 = +21分（胡分5分 + 杠分2分）
- 对北方：+6 × 4 = +24分（胡分5分 + 杠分1分）
- 小计 = 48 + 21 + 24 = +93分
- 最终得分 = 93 × 5 = +465分

#### 西方最终得分
- 对东方：-2 × 4 = -8分
- 对南方：-7 × 5 = -35分（胡分5分 + 杠分2分）
- 小计 = -8 - 35 = -43分
- 最终得分 = -43 × 3 = -129分

#### 北方最终得分
- 对东方：-2 × 4 = -8分
- 对南方：-6 × 5 = -30分（胡分5分 + 杠分1分）
- 小计 = -8 - 30 = -38分
- 最终得分 = -38 × 4 = -152分

#### 验证
- 东方：-184分
- 南方：+465分
- 西方：-129分
- 北方：-152分
- 总和：-184 + 465 - 129 - 152 = 0 ✓
